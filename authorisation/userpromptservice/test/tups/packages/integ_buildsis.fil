!IF "$(PLATFORM)" == "GCCXML" || "$(PLATFORM)" == "TOOLS" || "$(PLATFORM)" == "TOOLS2" 
MAKEDATA :
	cd
	echo ----------------
	echo  Do nothing ...
	echo ----------------
!ELSE

!IF "$(PLATFORM)" == "WINSCW"
$(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\z\tups\integ\packages\tupsinteg_post1.sis : $(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\tupsinteg_1.exe tupsinteg_post1.pkg
!ELSE
$(EPOCROOT)epoc32\data\z\tups\integ\packages\tupsinteg_post1.sis : $(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\tupsinteg_1.exe tupsinteg_post1.pkg
!ENDIF
	cd
	echo --------------------------------------------------------------
	echo Building SIS file to install removable test client
	echo --------------------------------------------------------------
	
	echo Copy executable to common location
	copy /y %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\tupsinteg_post1.exe tupsinteg_post1.exe
	
	echo makesis
	makesis tupsinteg_post1.pkg tupsinteg_post1_unsigned.sis
	del /q  tupsinteg_post1.exe
	
	echo signsis	
	signsis tupsinteg_post1_unsigned.sis tupsinteg_post1.sis   %SECURITYSOURCEDIR%\testframework\testcertificates\ups\test\root5ca\ca.pem  %SECURITYSOURCEDIR%\testframework\testcertificates\ups\test\root5ca\ca.key.pem
	del /q tupsinteg_post1_unsigned.sis 
		
	echo Copy winscw sis to emulator drive or armv5 to data z tree
	if "$(PLATFORM)" == "WINSCW" copy /y tupsinteg_post1.sis %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_post1.sis 
	if "$(PLATFORM)" == "ARMV5"  copy /y tupsinteg_post1.sis %EPOCROOT%epoc32\data\z\tups\integ\packages\tupsinteg_post1.sis 
	if exist tupsinteg_post1.sis	del /q tupsinteg_post1.sis 
	

!IF "$(PLATFORM)" == "WINSCW"
$(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\z\tups\integ\packages\tupsinteg_policies1.sis : $(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\Z\private\10283558\policies\t_ups_101f7f1f_ff000001_version1.rsc tupsinteg_policies1.pkg
!ELSE
$(EPOCROOT)epoc32\data\z\tups\integ\packages\tupsinteg_policies1.sis : $(EPOCROOT)epoc32\data\z\private\10283558\policies\t_ups_101f7f1f_ff000001_version1.rsc tupsinteg_policies1.pkg
!ENDIF
	echo --------------------------------------------------------------
	echo Building SIS to install policy files post manufacture.
	echo --------------------------------------------------------------
	
	echo RSC file to here
	if "$(PLATFORM)" == "WINSCW" copy /y %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\Z\private\10283558\policies\t_ups_101f7f1f_ff000001_version1.rsc 
	if "$(PLATFORM)" == "ARMV5"  copy /y %EPOCROOT%epoc32\data\z\private\10283558\policies\t_ups_101f7f1f_ff000001_version1.rsc 
	
	echo makesis
    makesis tupsinteg_policies1.pkg tupsinteg_policies1_unsigned.sis
	del /q t_ups_101f7f1f_ff000001_version1.rsc

	echo signsis	
	signsis tupsinteg_policies1_unsigned.sis tupsinteg_policies1.sis   %SECURITYSOURCEDIR%\testframework\testcertificates\ups\test\root5ca\ca.pem  %SECURITYSOURCEDIR%\testframework\testcertificates\ups\test\root5ca\ca.key.pem
	del /q tupsinteg_policies1_unsigned.sis

	echo Copy winscw sis to emulator drive or armv5 to data z tree
	if "$(PLATFORM)" == "WINSCW" copy /y tupsinteg_policies1.sis %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_policies1.sis 
	if "$(PLATFORM)" == "ARMV5" copy /y tupsinteg_policies1.sis %EPOCROOT%epoc32\data\z\tups\integ\packages\tupsinteg_policies1.sis
	 
	Rem Removes temporary files.
	del /q tupsinteg_policies1.sis 

!IF "$(PLATFORM)" == "WINSCW"
$(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\z\tups\integ\packages\tupsinteg_policies2.sis : $(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\Z\private\10283558\policies\t_ups_101f7f1f_ff000001_version2.rsc tupsinteg_policies2.pkg
!ELSE
$(EPOCROOT)epoc32\data\z\tups\integ\packages\tupsinteg_policies2.sis : $(EPOCROOT)epoc32\data\z\private\10283558\policies\t_ups_101f7f1f_ff000001_version2.rsc tupsinteg_policies2.pkg
!ENDIF
	echo --------------------------------------------------------------
	echo Building SIS to install policy files post manufacture.
	echo --------------------------------------------------------------
	
	echo RSC file to here
	if "$(PLATFORM)" == "WINSCW" copy /y %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\Z\private\10283558\policies\t_ups_101f7f1f_ff000001_version2.rsc 
	if "$(PLATFORM)" == "ARMV5"  copy /y %EPOCROOT%epoc32\data\z\private\10283558\policies\t_ups_101f7f1f_ff000001_version2.rsc 
	
	echo makesis
    makesis tupsinteg_policies2.pkg tupsinteg_policies2_unsigned.sis
	del /q t_ups_101f7f1f_ff000001_version2.rsc

	echo signsis	
	signsis tupsinteg_policies2_unsigned.sis tupsinteg_policies2.sis   %SECURITYSOURCEDIR%\testframework\testcertificates\ups\test\root5ca\ca.pem  	%SECURITYSOURCEDIR%\testframework\testcertificates\ups\test\root5ca\ca.key.pem
	del /q tupsinteg_policies2_unsigned.sis

	echo Copy winscw sis to emulator drive or armv5 to data z tree
	if "$(PLATFORM)" == "WINSCW" copy /y tupsinteg_policies2.sis %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_policies2.sis 
	if "$(PLATFORM)" == "ARMV5" copy /y tupsinteg_policies2.sis %EPOCROOT%epoc32\data\z\tups\integ\packages\tupsinteg_policies2.sis
	 
	Rem Removes temporary files.
	del /q tupsinteg_policies2.sis 

!IF "$(PLATFORM)" == "WINSCW"
MAKEDATA : $(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\z\tups\integ\packages\tupsinteg_post1.sis $(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\z\tups\integ\packages\tupsinteg_policies1.sis $(EPOCROOT)epoc32\release\$(PLATFORM)\$(CFG)\z\tups\integ\packages\tupsinteg_policies2.sis 
!ELSE
MAKEDATA : $(EPOCROOT)epoc32\data\z\tups\integ\packages\tupsinteg_post1.sis $(EPOCROOT)epoc32\data\z\tups\integ\packages\tupsinteg_policies1.sis $(EPOCROOT)epoc32\data\z\tups\integ\packages\tupsinteg_policies2.sis 
!ENDIF
	echo

!ENDIF


DO_NOTHING:
	rem do nothing

#
# The targets invoked by abld...
#

MAKMAKE : DO_NOTHING
FREEZE : DO_NOTHING
LIB : DO_NOTHING
RESOURCE : DO_NOTHING
CLEANLIB : DO_NOTHING
FINAL : DO_NOTHING
RELEASABLES : DO_NOTHING

SAVESPACE : BLD

BLD : MAKEDATA

CLEAN : 
	if exist %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_post1.sis 	del /q %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_post1.sis 
	if exist %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_policies1.sis 	del /q %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_policies1.sis 
	if exist %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_policies2.sis 	del /q %EPOCROOT%epoc32\release\"$(PLATFORM)"\"$(CFG)"\z\tups\integ\packages\tupsinteg_policies2.sis 
	

