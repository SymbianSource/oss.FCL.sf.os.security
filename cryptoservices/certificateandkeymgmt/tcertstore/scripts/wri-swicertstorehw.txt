// wri-swicertstore1.txt
//
// Test direct access to SWI cert store
//

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-1
//! @SYMTestCaseDesc Copy the swicertstore to 
//! c:\Resource\Swicertstore\dat\; and open the SWI cert store
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Open the SWI cert store</actionname>
	<actiontype>initswicertstore</actiontype>
	<actionbody>
		<filename>c:\tcertstore\data\wri-swicertstore.dat</filename>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-2
//! @SYMTestCaseDesc Get the list of CA certificates
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get the list of CA certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>TSecuritySymbianTestTCBRSACA</label></CCTCertInfo>
		<CCTCertInfo><label>Root5CA</label><readonly>True</readonly></CCTCertInfo>
		<CCTCertInfo><label>SymbianTestDSACA</label><readonly>True</readonly></CCTCertInfo>
		<CCTCertInfo><label>SymbianTestRSACA</label><readonly>True</readonly></CCTCertInfo>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-3
//! @SYMTestCaseDesc Retrieve Root5CA cert
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Retrieve Root5CA cert</actionname>
	<actiontype>retrieve</actiontype>
	<actionbody>
		<label>Root5CA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-4
//! @SYMTestCaseDesc Retrieve TSecuritySymbianTestTCBRSACA cert
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Retrieve TSecuritySymbianTestTCBRSACA cert</actionname>
	<actiontype>retrieve</actiontype>
	<actionbody>
		<label>TSecuritySymbianTestTCBRSACA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-5
//! @SYMTestCaseDesc Get applications for Root5CA
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get applications for Root5CA</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>Root5CA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>268452523</uid>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-6
//! @SYMTestCaseDesc Get applications for TSecuritySymbianTestTCBRSACA
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get applications for TSecuritySymbianTestTCBRSACA</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>TSecuritySymbianTestTCBRSACA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>268452523 268478646</uid>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-7
//! @SYMTestCaseDesc Get the trust for SymbianTestDSACA
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get the trust for SymbianTestDSACA</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>SymbianTestDSACA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-8
//! @SYMTestCaseDesc Get the trust for TSecuritySymbianTestTCBRSACA
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get the trust for TSecuritySymbianTestTCBRSACA</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>TSecuritySymbianTestTCBRSACA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-9
//! @SYMTestCaseDesc Get the capabilities for SymbianTestDSACA
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get the capabilities for SymbianTestDSACA</actionname>
	<actiontype>getcapabilities</actiontype>
	<actionbody>
		<label>SymbianTestDSACA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<capability>NetworkServices</capability>
		<capability>LocalServices</capability>
		<capability>Location</capability>
		<capability>MultimediaDD</capability>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-10
//! @SYMTestCaseDesc Get the capabilities for TSecuritySymbianTestTCBRSACA
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get the capabilities for TSecuritySymbianTestTCBRSACA</actionname>
	<actiontype>getcapabilities</actiontype>
	<actionbody>
		<label>TSecuritySymbianTestTCBRSACA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<capability>NetworkServices</capability>
		<capability>LocalServices</capability>
		<capability>Location</capability>
		<capability>MultimediaDD</capability>
		<capability>TCB</capability>
		<capability>DRM</capability>
		<capability>AllFiles</capability>
		<capability>ReadUserData</capability>
		<capability>WriteUserData</capability>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-11
//! @SYMTestCaseDesc Get the mandatory flag for SymbianTestRSACA
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get the mandatory flag for SymbianTestRSACA</actionname>
	<actiontype>getmandatory</actiontype>
	<actionbody>
		<label>SymbianTestRSACA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<mandatory>EFalse</mandatory>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-12
//! @SYMTestCaseDesc Get the mandatory flag for TSecuritySymbianTestTCBRSACA
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Get the mandatory flag for TSecuritySymbianTestTCBRSACA</actionname>
	<actiontype>getmandatory</actiontype>
	<actionbody>
		<label>TSecuritySymbianTestTCBRSACA</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<mandatory>EFalse</mandatory>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-13
//! @SYMTestCaseDesc Get TSecuritySymbianTestTCBRSACA by handle
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Getting the TSecuritySymbianTestTCBRSACA by handle</actionname>
	<actiontype>CUnifiedCertStore GetCert</actiontype>
	<actionbody>
			<tokentype>270549690</tokentype>
			<token>0</token>
			<object>6</object>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

//! @file
//! @SYMTestCaseID Sec-tcertstore-wri-swicertstore1-14
//! @SYMTestCaseDesc Deleting the SWI cert store
//! @SYMREQ REQ0000
//! @SYMTestCasePriority High
//! @SYMTestExpectedResults KErrNone
<action>
	<actionname>Deleting the SWI cert store</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
