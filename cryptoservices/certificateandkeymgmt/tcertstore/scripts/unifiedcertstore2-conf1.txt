//4.1 Test cases for single file-based writable certificate store

//4.1.1 Successfull addition, listing and retrieval of certificates (X.509)
<action>
	<actionname>No Test,Opening a CertificateAppInfoManager</actionname>
	<actiontype>initappmanager</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Adding client A1</actionname>
	<actiontype>addclient</actiontype>
	<actionbody>
		<name>A1</name>
		<uid>1</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Adding client A2</actionname>
	<actiontype>addclient</actiontype>
	<actionbody>
		<name>A2</name>
		<uid>2</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Adding client A3</actionname>
	<actiontype>addclient</actiontype>
	<actionbody>
		<name>A3</name>
		<uid>3</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Adding client A4</actionname>
	<actiontype>addclient</actiontype>
	<actionbody>
		<name>A4</name>
		<uid>4</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the CertificateAppInfoManager</actionname>
	<actiontype>deleteappmanager</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
<actionname>1.1.0.4 Import a RSA key</actionname>
	<actiontype>importkey</actiontype>
	<actionbody>
		<ImportData>rsacertkey1.txt</ImportData>
		<keyusage>AllUsagesButNR</keyusage>
		<keylabel>*IMPORTED* RSA key 1</keylabel>
		<keyaccesstype>Extractable</keyaccesstype>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
<actionname>1.1.0.5 Import a RSA key</actionname>
	<actiontype>importkey</actiontype>
	<actionbody>
		<ImportData>rsacertkey2.txt</ImportData>
		<keyusage>AllUsagesButNR</keyusage>
		<keylabel>*IMPORTED* RSA key 2</keylabel>
		<keyaccesstype>Extractable</keyaccesstype>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
<actionname>1.1.0.6 Import a RSA key</actionname>
	<actiontype>importkey</actiontype>
	<actionbody>
		<ImportData>rsacertkey3.txt</ImportData>
		<keyusage>AllUsagesButNR</keyusage>
		<keylabel>*IMPORTED* RSA key 3</keylabel>
		<keyaccesstype>Extractable</keyaccesstype>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.1,Opening a certificate store manager</actionname>
	<actiontype>init</actiontype>
	<actionbody>
		<mode>write</mode>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test, Deleting all certs ***NEW***</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<label>*.*</label>
		<deleteallcerts>1</deleteallcerts>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.1 Add user certificate with no corresponding private key</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>BadUserCert</label>
		<issuerkey></issuerkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX1.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrPrivateKeyNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.2 Add user certificate with no corresponding private key</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>BadUserCert</label>
		<issuerkey></issuerkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX2.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrPrivateKeyNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.3 Add user certificate with no corresponding private key</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>BadUserCert</label>
		<issuerkey></issuerkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX3.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrPrivateKeyNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.4,Add the certificate CAX1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>CAX1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.5,Add the certificate CAX2</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>CAX2</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX2.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.6,Add the certificate CAX3</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>CAX3</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX3.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.7,Get the list of certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
		<CCTCertInfo><label>CAX2</label></CCTCertInfo>
		<CCTCertInfo><label>CAX3</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.7.1,Retrieve CAX1 cert</actionname>
	<actiontype>retrieve</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.8,Get the list of certificates, searching by Issuer DN</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
		<issuerdn>c:\unifiedcertstore2\CAX1.cer</issuerdn>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.9,Get the list of certificates, searching by 2 Issuer DNs</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
		<issuerdn>c:\unifiedcertstore2\CAX1.cer</issuerdn>
		<issuerdn>c:\unifiedcertstore2\CAX2.cer</issuerdn>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
		<CCTCertInfo><label>CAX2</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.10,Get the list of certificates, searching by 3 Issuer DNs</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
		<issuerdn>c:\unifiedcertstore2\CAX1.cer</issuerdn>
		<issuerdn>c:\unifiedcertstore2\CAX2.cer</issuerdn>
		<issuerdn>c:\unifiedcertstore2\CAX3.cer</issuerdn>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
		<CCTCertInfo><label>CAX2</label></CCTCertInfo>
		<CCTCertInfo><label>CAX3</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.11,Deleting the certificate store manager</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.12,Opening a certificate store manager</actionname>
	<actiontype>init</actiontype>
	<actionbody>
		<mode>write</mode>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.13,Get the list of certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
		<CCTCertInfo><label>CAX2</label></CCTCertInfo>
		<CCTCertInfo><label>CAX3</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.14, Get a list of one certificate by specifying label CAX1</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
			<label>CAX1</label>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.1.15, Get a list of one certificate by specifying label CAX3</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
			<label>CAX3</label>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX3</label></CCTCertInfo>
	</actionresult>
</action>

//4.1.2 Successfull addition, listing and retrieval of certificates (WTLS)
<action>
	<actionname>4.1.2.1,Add the certificate CAW1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>WTLS</format>
		<label>CAW1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAW1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.2,Add the certificate CAW2</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>WTLS</format>
		<label>CAW2</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAW2.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.3,Add the certificate CAW3</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>WTLS</format>
		<label>CAW3</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAW3.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.4,Get the list of certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
		<CCTCertInfo><label>CAX2</label></CCTCertInfo>
		<CCTCertInfo><label>CAX3</label></CCTCertInfo>
		<CCTCertInfo><label>CAW1</label></CCTCertInfo>
		<CCTCertInfo><label>CAW2</label></CCTCertInfo>
		<CCTCertInfo><label>CAW3</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.4.1,List CAX1 by issuer DN</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
		<issuerdn>c:\unifiedcertstore2\CAX1.cer</issuerdn>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.4.2,Retrieve CAW1 cert</actionname>
	<actiontype>retrieve</actiontype>
	<actionbody>
		<label>CAW1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.5,Deleting the certificate store manager</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.6,Opening a certificate store manager</actionname>
	<actiontype>init</actiontype>
	<actionbody>
		<mode>write</mode>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.7,Get the list of certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
		<CCTCertInfo><label>CAX2</label></CCTCertInfo>
		<CCTCertInfo><label>CAX3</label></CCTCertInfo>
		<CCTCertInfo><label>CAW1</label></CCTCertInfo>
		<CCTCertInfo><label>CAW2</label></CCTCertInfo>
		<CCTCertInfo><label>CAW3</label></CCTCertInfo>
	</actionresult>
</action>

//4.1.3 Successfull trust settings updates and retrieval
<action>
	<actionname>4.1.3.1,Set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1 2 3</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.1.1,Set duplicate applications to the CAX1. Should leave with KErrArgument</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1 1 1</uid>
	</actionbody>
	<actionresult>
		<return>KErrArgument</return>
	</actionresult>
</action> 

<action>
	<actionname>4.1.3.2,set the trust for CAX1</actionname>
	<actiontype>settrust</actiontype> 
	<actionbody>
		<label>CAX1</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.3,Set applications to the CAX2 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX2</label>
		<uid>1</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>


<action>
	<actionname>4.1.3.3.1 Set duplicate applications to the CAX2. Should leave with KErrArgument</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX2</label>
		<uid>1 2 1</uid>
	</actionbody>
	<actionresult>
		<return>KErrArgument</return>
	</actionresult>
</action>


<action>
	<actionname>4.1.3.4,set the trust for CAX2</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAX2</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.5,Set applications to the CAX3 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX3</label>
		<uid></uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.6,set the trust for CAX3</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAX3</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.7,Get applications for CAX1</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1 2 3</uid>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.8,Get the trust for CAX1</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.9,Get applications for CAX2</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAX2</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1</uid>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.10,Get the trust for CAX2</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAX2</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.11,Get applications for CAX3</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAX3</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid></uid>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.12,Get the trust for CAX3</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAX3</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.13,Set trusters to the CAW2 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAW2</label>
		<uid>1 2 3</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.14,set the trust for CAW2</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAW2</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.15,Set trusters to the CAW3 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAW3</label>
		<uid>1 2</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.16,set the trust for CAW3</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAW3</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.17,Get applications for CAW1</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAW1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid></uid>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.18,Get the trust for CAW1</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAW1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>0</trust>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.19,Get applications for CAW2</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAW2</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1 2 3</uid>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.20,Get the trust for CAW2</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAW2</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.21,Get applications for CAW3</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAW3</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1 2</uid>
	</actionresult>
</action>

<action>
	<actionname>4.1.3.22,Get the trust for CAW3</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAW3</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>

///////////////////////////////////////////////////////////
//	Test multiple calls to setapplicability/settrust
<action>
	<actionname>4.1.3.1a,Set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1 2</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.2a,set the trust for CAX1</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAX1</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.7a,Get applications for CAX1</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1 2</uid>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.8a,Get the trust for CAX1</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>
///////////////////////////////////////////////////////////
<action>
	<actionname>4.1.3.1b,Set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1 2 3 4</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.2b,set the trust for CAX1</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAX1</label>
		<trust>0</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.7b,Get applications for CAX1</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1 2 3 4</uid>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.8b,Get the trust for CAX1</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>0</trust>
	</actionresult>
</action>
///////////////////////////////////////////////////////////
<action>
	<actionname>4.1.3.1c,Set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1 2 3</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.2c,set the trust for CAX1</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAX1</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.7c,Get applications for CAX1</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1 2 3</uid>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.8c,Get the trust for CAX1</actionname>
	<actiontype>gettrusters</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<trust>1</trust>
	</actionresult>
</action>
///////////////////////////////////////////////////////////
<action>
	<actionname>4.1.3.1d,Fail to set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1 2 3 4 5</uid>
	</actionbody>
	<actionresult>
		<return>KErrArgument</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.7d,Get applications for CAX1 from previous setting</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1 2 3</uid>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.2c,set the trust for CAX1</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAX1</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.1e,Set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1 2 3 4</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.1f,Fail to set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1 2 3 4 5 7 8 9</uid>
	</actionbody>
	<actionresult>
		<return>KErrArgument</return>
	</actionresult>
</action>
<action>
	<actionname>4.1.3.7f,Get applications for CAX1 from previous setting</actionname>
	<actiontype>getapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<uid>1 2 3 4</uid>
	</actionresult>
</action>
///////////////////////////////////////////////////////////
//4.1.4 Successful addition and retrieval of user certificates
<action>
	<actionname>4.1.4.1, Add certificate rsacert1 ***NEW***</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>rsacert1</label>
		<issuerkey></issuerkey>
		<subjectkey>4808f03892fe836e78d048bcefcca4a37913d886</subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\rsacert1.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>


<action>
	<actionname>4.1.4.2,Add the certificate rsacert2 ***NEW***</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>rsacert2</label>
		<issuerkey></issuerkey>
		<subjectkey>dc448293c7c3ed68c9fabd37db43007136ae2ef4</subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\rsacert2.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.2.3,Add the certificate rsacert3 ***NEW***</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>rsacert3</label>
		<issuerkey></issuerkey>
		<subjectkey>0b2e1d1d4dbae5fc59a02a5115d2c2910fa796e0</subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\rsacert3.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>4.1.4.4.a,Get the list of certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
		<CCTCertInfo><label>CAX2</label></CCTCertInfo>
		<CCTCertInfo><label>CAX3</label></CCTCertInfo>
		<CCTCertInfo><label>CAW1</label></CCTCertInfo>
		<CCTCertInfo><label>CAW2</label></CCTCertInfo>
		<CCTCertInfo><label>CAW3</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.4.4.b,Get the list of certificates ***NEW***</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>user</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>rsacert1</label></CCTCertInfo>
		<CCTCertInfo><label>rsacert2</label></CCTCertInfo>
		<CCTCertInfo><label>rsacert3</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.4.4.c,Get the list of certificates searching by DN</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>user</ownertype>
		</filter>
		<issuerdn>c:\unifiedcertstore2\rsacert1.cer</issuerdn>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		// All 3 user certs have same issuer
		<CCTCertInfo><label>rsacert1</label></CCTCertInfo>
		<CCTCertInfo><label>rsacert2</label></CCTCertInfo>
		<CCTCertInfo><label>rsacert3</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>4.1.4.4.c,Get the list of certificates searching by DNs</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>user</ownertype>
		</filter>
		<issuerdn>c:\unifiedcertstore2\CAX1.cer</issuerdn>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		// No user certs with this DN expected
	</actionresult>
</action>

<action>
	<actionname>4.1.4.4.e,Retrieve rsacert1 cert</actionname>
	<actiontype>retrieve</actiontype>
	<actionbody>
		<label>rsacert1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAX1</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAX2</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAX2</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAX3</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAX3</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAW1</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAW1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAW2</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAW2</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAW3</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAW3</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate rsacert1 ***NEW***</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>user</certtype>
		<label>rsacert1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate rsacert2 ***NEW***</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>user</certtype>
		<label>rsacert2</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate rsacert3 ***NEW***</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>user</certtype>
		<label>rsacert3</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate store manager</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

//7.1 Calling functions without initialising store
<action>
	<actionname>No test,Creating a certificate store manager</actionname>
	<actiontype>onlycreate</actiontype>
	<actionbody>
		<mode>write</mode>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.1.1,Get the list of CA certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNotReady</return>
	</actionresult>
</action>

<action>
	<actionname>7.1.2,Get the list of user certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>user</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNotReady</return>
	</actionresult>
</action>

<action>
	<actionname>No test,Deleting the certificate store manager</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>


//7.2 Trust settings for CA certificates
<action>
	<actionname>No Test,Opening a certificate store manager</actionname>
	<actiontype>init</actiontype>
	<actionbody>
		<mode>write</mode>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.2.1.a,Add the certificate CAX1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>CAX1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.2.1.b,Get the list of certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>ca</ownertype>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>CAX1</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>7.2.1.c,Set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>7</uid>
	</actionbody>
	<actionresult>
		<return>KErrArgument</return>
	</actionresult>
</action>

//7.3 Supplying bad user certificates
<action>
	<actionname>7.3.1,Add the certificate U5K3</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>U5K3</label>
		<issuerkey></issuerkey>
		<subjectkey>eeda2c6da84f17519ee837eadb8a5289dadfbb26</subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\U5K3.crt</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrPrivateKeyNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>7.3.2,Add the certificate U6K5 with wrong subject key</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>U6K5</label>
		<issuerkey></issuerkey>
		<subjectkey>eeda2c6da84f17519ee837eadb8a5289dadf0000</subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\U6K5.crt</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrArgument</return>
	</actionresult>
</action>

<action>
	<actionname>7.3.3,Add the certificate URL3K5</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509URL</format>
		<label>URL3K5</label>
		<issuerkey></issuerkey>
		<subjectkey>eeda2c6da84f17519ee837eadb8a5289dadf0000</subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\URL3K5.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrPrivateKeyNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAX1</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

//7.4
<action>
	<actionname>7.4.1.a,Add the certificate CAW1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>WTLS</format>
		<label>CAW1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAW1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.4.1.b,Add the certificate CAW1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>WTLS</format>
		<label>CAW1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAW1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrBadName</return>
	</actionresult>
</action>

<action>
	<actionname>7.4.2.a,Add the certificate CAX1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>CAX1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.4.2.b,Add the certificate CAX1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>CAX1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrBadName</return>
	</actionresult>
</action>


<action>
	<actionname>7.4.3.a, Add the certificate rsacert3 ***NEW***</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>rsacert3</label>
		<subjectkeyid>0b2e1d1d4dbae5fc59a02a5115d2c2910fa796e0</subjectkeyid>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\rsacert3.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.4.3.b, Add the certificate rsacert3 ***NEW***</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>rsacert3</label>
		<subjectkeyid>0b2e1d1d4dbae5fc59a02a5115d2c2910fa796e0</subjectkeyid>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\rsacert3.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrBadName</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAX1</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAW1</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAW1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate rsacert3 ***NEW***</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>user</certtype>
		<label>rsacert3</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

//7.5 Loading certificates
<action>
	<actionname>7.5.1.a,Add the certificate CAX1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>CAX1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.1.b,Add the certificate CAW1</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>WTLS</format>
		<label>CAW1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAW1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.1.c,Add the certificate URL1rsa1  ***NEW***</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509URL</format>
		<label>URL1rsa1</label>
		<issuerkey></issuerkey>
		<subjectkey>4808f03892fe836e78d048bcefcca4a37913d886</subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\URL1K1.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.1.d,Add the certificate URL2rsa2  ***NEW***</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509URL</format>
		<label>URL2rsa2</label>
		<issuerkey></issuerkey>
		<subjectkey>dc448293c7c3ed68c9fabd37db43007136ae2ef4</subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\URL2K2.cer</certfile>
		<certowner>user</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.1.e,List URL certificates</actionname>
	<actiontype>listcert</actiontype>
	<actionbody>
		<filter>
			<ownertype>user</ownertype>
			<formatflags>X509URL</formatflags>
		</filter>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
		<CCTCertInfo><label>URL1rsa1</label></CCTCertInfo>
		<CCTCertInfo><label>URL2rsa2</label></CCTCertInfo>
	</actionresult>
</action>

<action>
	<actionname>7.5.1.f,Retrieve URL1rsa1 cert</actionname>
	<actiontype>retrieve</actiontype>
	<actionbody>
		<label>URL1rsa1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.2,Deleting and retrieving the certificate CAX1</actionname>
	<actiontype>deleteandretrievecacert</actiontype>
	<actionbody>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.3,Deleting and retrieving the certificate CAW1</actionname>
	<actiontype>deleteandretrievecacert</actiontype>
	<actionbody>
		<label>CAW1</label>
	</actionbody>
	<actionresult>
		<return>KErrNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.4,Deleting and retrieving the certificate U1K1</actionname>
	<actiontype>deleteandretrieveusercert</actiontype>
	<actionbody>
		<label>U1K1</label>
	</actionbody>
	<actionresult>
		<return>KErrNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.5,Deleting and retrieving the certificate URL2rsa2</actionname>
	<actiontype>deleteandretrieveusercert</actiontype>
	<actionbody>
		<label>URL2rsa2</label>
	</actionbody>
	<actionresult>
		<return>KErrNotFound</return>
	</actionresult>
</action>

<action>
	<actionname>7.5.5,Deleting and retrieving the certificate URL1rsa1</actionname>
	<actiontype>deleteandretrieveusercert</actiontype>
	<actionbody>
		<label>URL1rsa1</label>
	</actionbody>
	<actionresult>
		<return>KErrNotFound</return>
	</actionresult>
</action>


<action>
	<actionname>No Test,Deleting the writable certificate store manager</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

// Start of tests 7.6
<action>
	<actionname>No Test,Opening a certificate store manager</actionname>
	<actiontype>init</actiontype>
	<actionbody>
		<mode>write</mode>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No test</actionname>
	<actiontype>addcert</actiontype>
	<actionbody>
		<format>X509</format>
		<label>CAX1</label>
		<issuerkey></issuerkey>
		<subjectkey></subjectkey>
		<certstore>0</certstore>
		<certfile>c:\unifiedcertstore2\CAX1.cer</certfile>
		<certowner>ca</certowner>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the writable certificate store manager</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Opening a certificate store manager</actionname>
	<actiontype>init</actiontype>
	<actionbody>
		<mode>read</mode>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>7.6.1,Deleting the certificate CAX1</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrAccessDenied</return>
	</actionresult>
</action>

<action>
	<actionname>7.6.2,Set applications to the CAX1 certificate</actionname>
	<actiontype>setapplications</actiontype>
	<actionbody>
		<label>CAX1</label>
		<uid>1</uid>
	</actionbody>
	<actionresult>
		<return>KErrAccessDenied</return>
	</actionresult>
</action>

<action>
	<actionname>7.6.3,Set the trust for CAX1</actionname>
	<actiontype>settrust</actiontype>
	<actionbody>
		<label>CAX1</label>
		<trust>1</trust>
	</actionbody>
	<actionresult>
		<return>KErrAccessDenied</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the writable certificate store manager</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Opening a certificate store manager</actionname>
	<actiontype>init</actiontype>
	<actionbody>
		<mode>write</mode>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the certificate CAX1</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<certtype>ca</certtype>
		<label>CAX1</label>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test, Deleting all certs ***NEW***</actionname>
	<actiontype>deletecert</actiontype>
	<actionbody>
		<label>*.*</label>
		<deleteallcerts>1</deleteallcerts>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the writable certificate store manager</actionname>
	<actiontype>delete</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

// End of tests, removing the clients
<action>
	<actionname>No Test,Opening a CertificateAppInfoManager</actionname>
	<actiontype>initappmanager</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the client A1</actionname>
	<actiontype>removeclient</actiontype>
	<actionbody>
		<uid>1</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the client A2</actionname>
	<actiontype>removeclient</actiontype>
	<actionbody>
		<uid>2</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the client A3</actionname>
	<actiontype>removeclient</actiontype>
	<actionbody>
		<uid>3</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the client A4</actionname>
	<actiontype>removeclient</actiontype>
	<actionbody>
		<uid>4</uid>
	</actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>

<action>
	<actionname>No Test,Deleting the CertificateAppInfoManager</actionname>
	<actiontype>deleteappmanager</actiontype>
	<actionbody></actionbody>
	<actionresult>
		<return>KErrNone</return>
	</actionresult>
</action>
